@using BookLibrary.Data.Services

@inherits LayoutComponentBase

@inject NavigationManager Url
@inject IToolbarService toolbarService

<MatAppBarContainer>
    <MatAppBar Fixed="true">
        <MatAppBarRow>
            <MatAppBarSection>
                <MatIconButton Icon="menu" @onclick="ToggleNavMenu"></MatIconButton>
                <MatAppBarTitle>@PageTitle</MatAppBarTitle>
            </MatAppBarSection>
            <MatAppBarSection Align="@MatAppBarSectionAlign.End">
                <MatIconButton Icon="account_circle" @onclick="LogOut">
                </MatIconButton>
            </MatAppBarSection>
        </MatAppBarRow>
    </MatAppBar>

    <MatAppBarContent>
        <MatDrawerContainer>
            <MatDrawer @bind-Opened="@showDrawer" Mode="@MatDrawerMode.Modal">
                <MatNavMenu Multi="true">
                    <MatNavItem Href="@Url.ToAbsoluteUri("").AbsoluteUri" NavLinkMatch="NavLinkMatch.All"><MatIcon Icon="home"></MatIcon>Home</MatNavItem>
                    <MatNavItem Href="@Url.ToAbsoluteUri("/Books/List").AbsoluteUri" NavLinkMatch="NavLinkMatch.All"><MatIcon Icon="book"></MatIcon>Books</MatNavItem>
                    <MatNavItem Href="@Url.ToAbsoluteUri("/Authors/List").AbsoluteUri" NavLinkMatch="NavLinkMatch.All"><MatIcon Icon="book"></MatIcon>Authors</MatNavItem>
                </MatNavMenu>
            </MatDrawer>
            <MatDrawerContent>
                <div class="padding-24">
                    @Body
                </div>
            </MatDrawerContent>
        </MatDrawerContainer>
    </MatAppBarContent>
</MatAppBarContainer>

<MatPortalHost></MatPortalHost>

@code {
    private bool showDrawer = false;

    private void ToggleNavMenu()
    {
        showDrawer = !showDrawer;
    }

    private void LogOut()
    {
        Url.NavigateTo("Identity/Account/Logout", true);
    }

    protected override void OnParametersSet()
    {
        PageTitle = string.IsNullOrEmpty(toolbarService.Title) ? "E-Book Library" : toolbarService.Title;
    }

    public string PageTitle { get; set; }
}